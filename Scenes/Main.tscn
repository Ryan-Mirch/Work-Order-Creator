[gd_scene load_steps=6 format=2]

[ext_resource path="res://Scenes/Header.tscn" type="PackedScene" id=1]
[ext_resource path="res://Scenes/SmallRow.tscn" type="PackedScene" id=2]

[sub_resource type="GDScript" id=1]
script/source = "extends Node2D

# Declare member variables here. Examples:
# var a = 2
# var b = \"text\"
onready var SideBar = $\"Side Bar\"
onready var VBox = $\"Side Bar/VBoxContainer\"

onready var TopBar = $\"Top Bar\"
onready var HBoxBackground  = $\"Top Bar/Viewport/Top Bar Background\"
onready var HBox = $\"Top Bar/Viewport/Top Bar Background/HBoxContainer\"
onready var Page = $\"Page\"
# Called when the node enters the scene tree for the first time.
func _ready():
	
	get_tree().get_root().connect(\"size_changed\", self, \"_screen_size_changed\")
	_screen_size_changed()

# Called every frame. 'delta' is the elapsed time since the previous frame.
func _process(delta):
	pass
	
func _screen_size_changed():
	
	SideBar.rect_size.y = get_viewport().size.y + 10
	VBox.rect_size.y = get_viewport().size.y + 10
	
	TopBar.rect_size.x = get_viewport().size.x + 10
	HBoxBackground.rect_size.x = get_viewport().size.x + 10
	HBox.rect_size.x = get_viewport().size.x + 10
	
	Page.rect_size.y = get_viewport().size.y - TopBar.rect_size.y - 50
	
	var page_space = get_viewport().size.x - SideBar.rect_size.x
	
	if(get_viewport().size.x > 850 + SideBar.rect_size.x):
		Page.rect_position.x = SideBar.rect_size.x + (page_space - 850)*0.5
	else:
		Page.rect_position.x = SideBar.rect_size.x
	"

[sub_resource type="GDScript" id=2]
script/source = "extends Button

# Declare member variables here. Examples:
# var a = 2
# var b = \"text\"
# Called when the node enters the scene tree for the first time.
func _ready():
	pass # Replace with function body.

# Called every frame. 'delta' is the elapsed time since the previous frame.
func _process(delta):
	pass
	
"

[sub_resource type="GDScript" id=3]
script/source = "extends FileDialog

# Declare member variables here. Examples:
# var a = 2
# var b = \"text\"
onready var SideBar = $\"../Side Bar\"
onready var TopBar = $\"../Top Bar/Viewport/Top Bar\"
onready var PageViewport = $\"../Page/ViewportContainer/Viewport\"

var folder
var pause = 0
# Called when the node enters the scene tree for the first time.
func _ready():
	pass # Replace with function body.

# Called every frame. 'delta' is the elapsed time since the previous frame.
func _process(delta):
	pass
		
func _on_FileDialog_dir_selected(dir):
	folder = dir
	_take_screenshot()
	_finished()
		
func _take_screenshot():
	var img = PageViewport.get_texture().get_data()
	img.flip_y()
	img.save_png(folder + \"/test.png\")
	
func _finished():	
	PageViewport.gui_disable_input = false
	
	folder = null
	pause = 0	
	for lineEdit in get_tree().get_nodes_in_group(\"Line Edit\"):
		lineEdit.visible = true

func _on_Export_pressed():
	PageViewport.gui_disable_input = true
	for lineEdit in get_tree().get_nodes_in_group(\"Line Edit\"):
		lineEdit.visible = false
	
	popup()

func _on_Save_Pages_As_PNG_popup_hide():
	if folder == null:
		_finished()
"

[node name="Node2D" type="Node2D"]
script = SubResource( 1 )

[node name="Page" type="ScrollContainer" parent="."]
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
margin_left = 199.993
margin_top = 75.0
margin_right = 1069.99
margin_bottom = 775.0
rect_clip_content = false
scroll_horizontal_enabled = false

[node name="ViewportContainer" type="ViewportContainer" parent="Page"]
margin_right = 850.0
margin_bottom = 1100.0
rect_min_size = Vector2( 850, 1100 )
mouse_filter = 2

[node name="Viewport" type="Viewport" parent="Page/ViewportContainer"]
size = Vector2( 850, 1100 )
transparent_bg = true
handle_input_locally = false
disable_3d = true
usage = 0
render_target_update_mode = 3

[node name="ColorRect" type="ColorRect" parent="Page/ViewportContainer/Viewport"]
margin_right = 900.0
margin_bottom = 1200.0
mouse_filter = 2
color = Color( 0.870588, 0.870588, 0.870588, 1 )

[node name="VBoxContainer" type="VBoxContainer" parent="Page/ViewportContainer/Viewport"]
margin_right = 600.0
margin_bottom = 600.0
mouse_filter = 2
custom_constants/separation = 0

[node name="Header" parent="Page/ViewportContainer/Viewport/VBoxContainer" instance=ExtResource( 1 )]
rect_min_size = Vector2( 850, 300 )

[node name="Small Row" parent="Page/ViewportContainer/Viewport/VBoxContainer" instance=ExtResource( 2 )]
margin_top = 300.0
margin_bottom = 350.0
rect_min_size = Vector2( 850, 50 )

[node name="Small Row2" parent="Page/ViewportContainer/Viewport/VBoxContainer" instance=ExtResource( 2 )]
margin_top = 350.0
margin_bottom = 400.0
rect_min_size = Vector2( 600, 50 )

[node name="Small Row3" parent="Page/ViewportContainer/Viewport/VBoxContainer" instance=ExtResource( 2 )]
margin_top = 400.0
margin_bottom = 450.0
rect_min_size = Vector2( 600, 50 )

[node name="Small Row4" parent="Page/ViewportContainer/Viewport/VBoxContainer" instance=ExtResource( 2 )]
margin_top = 450.0
margin_bottom = 500.0
rect_min_size = Vector2( 600, 50 )

[node name="Small Row5" parent="Page/ViewportContainer/Viewport/VBoxContainer" instance=ExtResource( 2 )]
margin_top = 500.0
margin_bottom = 550.0
rect_min_size = Vector2( 600, 50 )

[node name="Small Row6" parent="Page/ViewportContainer/Viewport/VBoxContainer" instance=ExtResource( 2 )]
margin_top = 550.0
margin_bottom = 600.0
rect_min_size = Vector2( 600, 50 )

[node name="Small Row7" parent="Page/ViewportContainer/Viewport/VBoxContainer" instance=ExtResource( 2 )]
margin_top = 600.0
margin_bottom = 650.0
rect_min_size = Vector2( 600, 50 )

[node name="Side Bar" type="ColorRect" parent="."]
editor/display_folded = true
margin_right = 200.0
margin_bottom = 850.0

[node name="VBoxContainer" type="VBoxContainer" parent="Side Bar"]
margin_right = 200.0
margin_bottom = 40.0
mouse_filter = 0

[node name="Top Bar" type="ViewportContainer" parent="."]
editor/display_folded = true
margin_right = 1195.0
margin_bottom = 50.0
rect_min_size = Vector2( 850, 50 )
mouse_filter = 2
stretch = true

[node name="Viewport" type="Viewport" parent="Top Bar"]
size = Vector2( 1195, 50 )
transparent_bg = true
handle_input_locally = false
disable_3d = true
usage = 0
render_target_update_mode = 3

[node name="Top Bar Background" type="ColorRect" parent="Top Bar/Viewport"]
margin_right = 1200.0
margin_bottom = 50.0
color = Color( 0.478431, 0.478431, 0.478431, 1 )

[node name="HBoxContainer" type="HBoxContainer" parent="Top Bar/Viewport/Top Bar Background"]
margin_top = 10.0
margin_right = 1022.0
margin_bottom = 40.0
mouse_filter = 0
alignment = 1

[node name="Projects" type="Button" parent="Top Bar/Viewport/Top Bar Background/HBoxContainer"]
margin_left = 395.0
margin_right = 459.0
margin_bottom = 30.0
text = "Projects"

[node name="Add Page" type="Button" parent="Top Bar/Viewport/Top Bar Background/HBoxContainer"]
margin_left = 463.0
margin_right = 517.0
margin_bottom = 30.0
text = "+ Page"

[node name="Add Row" type="Button" parent="Top Bar/Viewport/Top Bar Background/HBoxContainer"]
margin_left = 521.0
margin_right = 571.0
margin_bottom = 30.0
text = "+ Row"

[node name="Export" type="Button" parent="Top Bar/Viewport/Top Bar Background/HBoxContainer"]
margin_left = 575.0
margin_right = 627.0
margin_bottom = 30.0
text = "Export"
script = SubResource( 2 )

[node name="Save Pages As PNG" type="FileDialog" parent="."]
margin_left = 165.0
margin_top = 74.0
margin_right = 677.0
margin_bottom = 426.0
popup_exclusive = true
window_title = "Open a Directory"
resizable = true
mode = 2
access = 2
current_dir = "C:/Users/rwmir/Development/Godot/Projects/Work-Order-Creator"
current_path = "C:/Users/rwmir/Development/Godot/Projects/Work-Order-Creator/"
script = SubResource( 3 )
[connection signal="pressed" from="Top Bar/Viewport/Top Bar Background/HBoxContainer/Export" to="Top Bar/Viewport/Top Bar Background/HBoxContainer/Export" method="_on_Export_pressed"]
[connection signal="pressed" from="Top Bar/Viewport/Top Bar Background/HBoxContainer/Export" to="Save Pages As PNG" method="_on_Export_pressed"]
[connection signal="confirmed" from="Save Pages As PNG" to="Top Bar/Viewport/Top Bar Background/HBoxContainer/Export" method="_on_FileDialog_confirmed"]
[connection signal="dir_selected" from="Save Pages As PNG" to="Top Bar/Viewport/Top Bar Background/HBoxContainer/Export" method="_on_FileDialog_dir_selected"]
[connection signal="dir_selected" from="Save Pages As PNG" to="Save Pages As PNG" method="_on_FileDialog_dir_selected"]
[connection signal="modal_closed" from="Save Pages As PNG" to="Save Pages As PNG" method="_on_FileDialog_modal_closed"]
[connection signal="popup_hide" from="Save Pages As PNG" to="Save Pages As PNG" method="_on_Save_Pages_As_PNG_popup_hide"]
[connection signal="tree_exited" from="Save Pages As PNG" to="Save Pages As PNG" method="_on_FileDialog_tree_exited"]
[connection signal="visibility_changed" from="Save Pages As PNG" to="Save Pages As PNG" method="_on_FileDialog_visibility_changed"]
